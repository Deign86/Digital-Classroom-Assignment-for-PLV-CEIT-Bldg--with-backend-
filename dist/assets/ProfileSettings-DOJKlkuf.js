import{r as i,j as s,S as G,m as W,L as U,k as q,l as V}from"./radix-vendor-aPP0ZBMt.js";import{c as d,L as l,I as b,B as J,A as K,r as Q,s as X,t as ss,u as es,v as rs,w as as,x as ts,H as os}from"./index-DyfdXshC.js";import{a as $}from"./utils-vendor-Cr9tsIwC.js";import{t as f}from"./analytics-sonner-C2wJrx07.js";import{U as E,M as ns,y as P,B as is,L as h,E as N,z as C,d as S,c as ds}from"./lucide-react-Eou995ch.js";function g(t,e,o){return function({className:u,...m}){const p=t;return i.createElement(p,{"data-slot":e,className:d(o??"",u),...m})}}const T=g("div","card","bg-card text-card-foreground flex flex-col gap-6 rounded-xl border"),z=g("div","card-header","@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6"),L=g("h4","card-title","leading-none"),B=g("div","card-description","text-muted-foreground"),R=g("div","card-content","px-6 [&:last-child]:pb-6"),ls=$("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function cs({className:t,variant:e,asChild:o=!1,...c}){const u=o?G:"span";return s.jsx(u,{"data-slot":"badge",className:d(ls({variant:e}),t),...c})}const Ps=W,us=i.forwardRef(({className:t,...e},o)=>s.jsx(U,{ref:o,className:d("bg-gray-100 text-gray-600 relative inline-flex h-10 w-full items-center justify-center rounded-xl p-1",t),...e}));us.displayName=U.displayName;const ms=i.forwardRef(({className:t,...e},o)=>s.jsx(q,{ref:o,className:d("relative z-10 inline-flex items-center justify-center whitespace-nowrap rounded-lg px-3 py-1.5 text-sm font-medium ring-offset-background transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm hover:text-gray-900",t),...e}));ms.displayName=q.displayName;const ws=i.forwardRef(({className:t,...e},o)=>s.jsx(V,{ref:o,className:d("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));ws.displayName=V.displayName;function Ns({className:t,...e}){return s.jsx("textarea",{"data-slot":"textarea",className:d("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...e})}const gs=$("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function xs({className:t,variant:e,...o}){return s.jsx("div",{"data-slot":"alert",role:"alert",className:d(gs({variant:e}),t),...o})}function fs({className:t,...e}){return s.jsx("div",{"data-slot":"alert-description",className:d("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...e})}function Cs({user:t}){const[e,o]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[c,u]=i.useState(!1),[m,p]=i.useState(!1),[v,_]=i.useState(!1),[k,A]=i.useState(!1),[I,y]=i.useState(!1),[n,w]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),M=()=>{const a={currentPassword:"",newPassword:"",confirmPassword:""};let r=!0;if(e.currentPassword||(a.currentPassword="Current password is required",r=!1),!e.newPassword)a.newPassword="New password is required",r=!1;else if(e.newPassword.length<8)a.newPassword="Password must be at least 8 characters long",r=!1;else{const j=/[A-Z]/.test(e.newPassword),x=/[a-z]/.test(e.newPassword),O=/[0-9]/.test(e.newPassword),Z=/[!@#$%^&*(),.?":{}|<>]/.test(e.newPassword);!j||!x||!O||!Z?(a.newPassword="Password must contain uppercase, lowercase, number, and special character",r=!1):e.newPassword===e.currentPassword&&(a.newPassword="New password cannot be the same as the current password",r=!1)}return e.confirmPassword?e.newPassword!==e.confirmPassword&&(a.confirmPassword="Passwords do not match",r=!1):(a.confirmPassword="Please confirm your password",r=!1),w(a),r},D=a=>{if(!a)return a;let r=a.replace(/[\r\n\t]/g,"");return r=r.replace(/[\u200B\u200C\u200D\uFEFF]/g,""),r=r.trim(),r},H=a=>{a.preventDefault(),w({currentPassword:"",newPassword:"",confirmPassword:""});const r=D(e.newPassword),j=D(e.confirmPassword);o(x=>({...x,newPassword:r,confirmPassword:j})),setTimeout(()=>{M()&&y(!0)},0)},Y=async()=>{y(!1),A(!0),f.info("Updating password...",{description:"Please wait while we securely update your password.",duration:2e3});try{const a=await os.updatePassword(e.currentPassword,e.newPassword);a.success?(f.success("Password Changed Successfully!",{description:"For security, you will now be logged out. Please log back in with your new password.",duration:3e3}),o({currentPassword:"",newPassword:"",confirmPassword:""})):f.error("Failed to update password",{description:a.message})}catch(a){console.error("Password update error:",a);const r=a instanceof Error?a.message:"An error occurred while updating password";f.error("Failed to update password",{description:r})}finally{A(!1)}},F=(a=>{if(a.length===0)return{strength:"",color:""};let r=0;return a.length>=8&&r++,a.length>=12&&r++,/[A-Z]/.test(a)&&r++,/[a-z]/.test(a)&&r++,/[0-9]/.test(a)&&r++,/[!@#$%^&*(),.?":{}|<>]/.test(a)&&r++,r<=2?{strength:"Weak",color:"text-red-600"}:r<=4?{strength:"Fair",color:"text-yellow-600"}:r<=5?{strength:"Good",color:"text-blue-600"}:{strength:"Strong",color:"text-green-600"}})(e.newPassword);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(T,{children:[s.jsxs(z,{children:[s.jsxs(L,{className:"flex items-center gap-2",children:[s.jsx(E,{className:"h-5 w-5"}),"Profile Information"]}),s.jsx(B,{children:"Your account details and role information"})]}),s.jsx(R,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Full Name"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(E,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.name})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Email Address"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(ns,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.email})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Role"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(P,{className:"h-4 w-4 text-gray-500"}),s.jsx(cs,{variant:t.role==="admin"?"default":"secondary",children:t.role==="admin"?"Administrator":"Faculty"})]})]}),t.department&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Department"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(is,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.department})]})]})]})})]}),s.jsxs(T,{children:[s.jsxs(z,{children:[s.jsxs(L,{className:"flex items-center gap-2",children:[s.jsx(h,{className:"h-5 w-5"}),"Change Password"]}),s.jsx(B,{children:"Update your password to keep your account secure"})]}),s.jsxs(R,{children:[s.jsxs("form",{onSubmit:H,className:"space-y-6",children:[s.jsxs(xs,{children:[s.jsx(P,{className:"h-4 w-4"}),s.jsxs(fs,{children:[s.jsx("strong",{children:"Security Notice:"})," For your protection, changing your password will sign you out of all active sessions on all devices. You will need to sign back in with your new password."]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Password Requirements:"}),s.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[s.jsx("li",{children:"At least 8 characters long"}),s.jsx("li",{children:"Contains uppercase and lowercase letters"}),s.jsx("li",{children:"Contains at least one number"}),s.jsx("li",{children:"Contains at least one special character (e.g., !@#$%^&*)"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"current-password",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(b,{id:"current-password",type:c?"text":"password",placeholder:"Enter your current password",value:e.currentPassword,onChange:a=>{o(r=>({...r,currentPassword:a.target.value})),n.currentPassword&&w(r=>({...r,currentPassword:""}))},className:`pl-10 pr-10 ${n.currentPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?s.jsx(N,{className:"h-4 w-4"}):s.jsx(C,{className:"h-4 w-4"})})]}),n.currentPassword&&s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(S,{className:"h-3 w-3"}),n.currentPassword]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"new-password",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(b,{id:"new-password",type:m?"text":"password",placeholder:"Enter new password",value:e.newPassword,onChange:a=>{o(r=>({...r,newPassword:a.target.value})),n.newPassword&&w(r=>({...r,newPassword:""}))},className:`pl-10 pr-10 ${n.newPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m?s.jsx(N,{className:"h-4 w-4"}):s.jsx(C,{className:"h-4 w-4"})})]}),n.newPassword?s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(S,{className:"h-3 w-3"}),n.newPassword]}):e.newPassword&&s.jsxs("p",{className:`text-sm font-medium ${F.color}`,children:["Strength: ",F.strength]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"confirm-password",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(b,{id:"confirm-password",type:v?"text":"password",placeholder:"Confirm new password",value:e.confirmPassword,onChange:a=>{o(r=>({...r,confirmPassword:a.target.value})),n.confirmPassword&&w(r=>({...r,confirmPassword:""}))},className:`pl-10 pr-10 ${n.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>_(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:v?s.jsx(N,{className:"h-4 w-4"}):s.jsx(C,{className:"h-4 w-4"})})]}),n.confirmPassword?s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(S,{className:"h-3 w-3"}),n.confirmPassword]}):e.confirmPassword&&e.newPassword===e.confirmPassword&&s.jsxs("p",{className:"text-sm font-medium text-green-600 flex items-center gap-1",children:[s.jsx(ds,{className:"h-3 w-3"}),"Passwords match"]})]})]}),s.jsx("div",{className:"flex gap-3",children:s.jsx(J,{type:"submit",disabled:k||!e.currentPassword||!e.newPassword||!e.confirmPassword,className:"flex-1",children:k?"Updating...":"Update Password"})})]}),s.jsx(K,{open:I,onOpenChange:y,children:s.jsxs(Q,{children:[s.jsxs(X,{children:[s.jsxs(ss,{className:"flex items-center gap-2",children:[s.jsx(P,{className:"h-5 w-5 text-amber-500"}),"Confirm Password Change"]}),s.jsx(es,{children:s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsx("p",{children:"Are you sure you want to change your password? This action will:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[s.jsx("li",{children:"Update your account password immediately"}),s.jsx("li",{children:"Log you out from all devices and sessions"}),s.jsx("li",{children:"Require you to log back in with your new password"})]}),s.jsx("p",{className:"font-medium text-amber-600",children:"Make sure you remember your new password before proceeding."})]})})]}),s.jsxs(rs,{children:[s.jsx(as,{children:"Cancel"}),s.jsx(ts,{onClick:Y,className:"bg-blue-600 hover:bg-blue-700",children:"Yes, Change Password"})]})]})})]})]})]})}export{cs as B,T as C,Cs as P,Ns as T,z as a,L as b,B as c,R as d,Ps as e,us as f,ms as g,ws as h};
