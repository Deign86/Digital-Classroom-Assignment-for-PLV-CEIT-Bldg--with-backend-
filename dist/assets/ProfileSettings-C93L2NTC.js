import{j as s,S as Z,m as G,r as d,L as B,k as R,l as U}from"./radix-vendor-aPP0ZBMt.js";import{c as i,L as l,I as j,B as W,A as J,r as K,s as Q,t as X,u as ss,v as es,w as rs,x as as,H as ts}from"./index-Bpv7uxBs.js";import{a as q}from"./utils-vendor-Cr9tsIwC.js";import{t as w}from"./analytics-sonner-C2wJrx07.js";import{U as D,M as ns,y,B as os,L as x,E as b,z as P,d as N,c as is}from"./lucide-react-Eou995ch.js";function F({className:t,...e}){return s.jsx("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",t),...e})}function E({className:t,...e}){return s.jsx("div",{"data-slot":"card-header",className:i("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...e})}function T({className:t,...e}){return s.jsx("h4",{"data-slot":"card-title",className:i("leading-none",t),...e})}function z({className:t,...e}){return s.jsx("div",{"data-slot":"card-description",className:i("text-muted-foreground",t),...e})}function L({className:t,...e}){return s.jsx("div",{"data-slot":"card-content",className:i("px-6 [&:last-child]:pb-6",t),...e})}const ds=q("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function ls({className:t,variant:e,asChild:n=!1,...c}){const g=n?Z:"span";return s.jsx(g,{"data-slot":"badge",className:i(ds({variant:e}),t),...c})}const bs=G,cs=d.forwardRef(({className:t,...e},n)=>s.jsx(B,{ref:n,className:i("bg-gray-100 text-gray-600 relative inline-flex h-10 w-full items-center justify-center rounded-xl p-1",t),...e}));cs.displayName=B.displayName;const us=d.forwardRef(({className:t,...e},n)=>s.jsx(R,{ref:n,className:i("relative z-10 inline-flex items-center justify-center whitespace-nowrap rounded-lg px-3 py-1.5 text-sm font-medium ring-offset-background transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm hover:text-gray-900",t),...e}));us.displayName=R.displayName;const ms=d.forwardRef(({className:t,...e},n)=>s.jsx(U,{ref:n,className:i("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));ms.displayName=U.displayName;function Ps({className:t,...e}){return s.jsx("textarea",{"data-slot":"textarea",className:i("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...e})}const ws=q("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function xs({className:t,variant:e,...n}){return s.jsx("div",{"data-slot":"alert",role:"alert",className:i(ws({variant:e}),t),...n})}function gs({className:t,...e}){return s.jsx("div",{"data-slot":"alert-description",className:i("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...e})}function Ns({user:t}){const[e,n]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[c,g]=d.useState(!1),[f,V]=d.useState(!1),[h,$]=d.useState(!1),[C,S]=d.useState(!1),[_,p]=d.useState(!1),[o,u]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),I=()=>{const a={currentPassword:"",newPassword:"",confirmPassword:""};let r=!0;if(e.currentPassword||(a.currentPassword="Current password is required",r=!1),!e.newPassword)a.newPassword="New password is required",r=!1;else if(e.newPassword.length<8)a.newPassword="Password must be at least 8 characters long",r=!1;else{const v=/[A-Z]/.test(e.newPassword),m=/[a-z]/.test(e.newPassword),Y=/[0-9]/.test(e.newPassword),O=/[!@#$%^&*(),.?":{}|<>]/.test(e.newPassword);!v||!m||!Y||!O?(a.newPassword="Password must contain uppercase, lowercase, number, and special character",r=!1):e.newPassword===e.currentPassword&&(a.newPassword="New password cannot be the same as the current password",r=!1)}return e.confirmPassword?e.newPassword!==e.confirmPassword&&(a.confirmPassword="Passwords do not match",r=!1):(a.confirmPassword="Please confirm your password",r=!1),u(a),r},k=a=>{if(!a)return a;let r=a.replace(/[\r\n\t]/g,"");return r=r.replace(/[\u200B\u200C\u200D\uFEFF]/g,""),r=r.trim(),r},M=a=>{a.preventDefault(),u({currentPassword:"",newPassword:"",confirmPassword:""});const r=k(e.newPassword),v=k(e.confirmPassword);n(m=>({...m,newPassword:r,confirmPassword:v})),setTimeout(()=>{I()&&p(!0)},0)},H=async()=>{p(!1),S(!0),w.info("Updating password...",{description:"Please wait while we securely update your password.",duration:2e3});try{const a=await ts.updatePassword(e.currentPassword,e.newPassword);a.success?(w.success("Password Changed Successfully!",{description:"For security, you will now be logged out. Please log back in with your new password.",duration:3e3}),n({currentPassword:"",newPassword:"",confirmPassword:""})):w.error("Failed to update password",{description:a.message})}catch(a){console.error("Password update error:",a);const r=a instanceof Error?a.message:"An error occurred while updating password";w.error("Failed to update password",{description:r})}finally{S(!1)}},A=(a=>{if(a.length===0)return{strength:"",color:""};let r=0;return a.length>=8&&r++,a.length>=12&&r++,/[A-Z]/.test(a)&&r++,/[a-z]/.test(a)&&r++,/[0-9]/.test(a)&&r++,/[!@#$%^&*(),.?":{}|<>]/.test(a)&&r++,r<=2?{strength:"Weak",color:"text-red-600"}:r<=4?{strength:"Fair",color:"text-yellow-600"}:r<=5?{strength:"Good",color:"text-blue-600"}:{strength:"Strong",color:"text-green-600"}})(e.newPassword);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(F,{children:[s.jsxs(E,{children:[s.jsxs(T,{className:"flex items-center gap-2",children:[s.jsx(D,{className:"h-5 w-5"}),"Profile Information"]}),s.jsx(z,{children:"Your account details and role information"})]}),s.jsx(L,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Full Name"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(D,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.name})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Email Address"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(ns,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.email})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Role"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(y,{className:"h-4 w-4 text-gray-500"}),s.jsx(ls,{variant:t.role==="admin"?"default":"secondary",children:t.role==="admin"?"Administrator":"Faculty"})]})]}),t.department&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Department"}),s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[s.jsx(os,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:t.department})]})]})]})})]}),s.jsxs(F,{children:[s.jsxs(E,{children:[s.jsxs(T,{className:"flex items-center gap-2",children:[s.jsx(x,{className:"h-5 w-5"}),"Change Password"]}),s.jsx(z,{children:"Update your password to keep your account secure"})]}),s.jsxs(L,{children:[s.jsxs("form",{onSubmit:M,className:"space-y-6",children:[s.jsxs(xs,{children:[s.jsx(y,{className:"h-4 w-4"}),s.jsxs(gs,{children:[s.jsx("strong",{children:"Security Notice:"})," For your protection, changing your password will sign you out of all active sessions on all devices. You will need to sign back in with your new password."]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Password Requirements:"}),s.jsxs("ul",{className:"text-sm text-muted-foreground list-disc list-inside space-y-1",children:[s.jsx("li",{children:"At least 8 characters long"}),s.jsx("li",{children:"Contains uppercase and lowercase letters"}),s.jsx("li",{children:"Contains at least one number"}),s.jsx("li",{children:"Contains at least one special character (e.g., !@#$%^&*)"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"current-password",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(j,{id:"current-password",type:c?"text":"password",placeholder:"Enter your current password",value:e.currentPassword,onChange:a=>{n(r=>({...r,currentPassword:a.target.value})),o.currentPassword&&u(r=>({...r,currentPassword:""}))},className:`pl-10 pr-10 ${o.currentPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>g(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?s.jsx(b,{className:"h-4 w-4"}):s.jsx(P,{className:"h-4 w-4"})})]}),o.currentPassword&&s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(N,{className:"h-3 w-3"}),o.currentPassword]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"new-password",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(j,{id:"new-password",type:f?"text":"password",placeholder:"Enter new password",value:e.newPassword,onChange:a=>{n(r=>({...r,newPassword:a.target.value})),o.newPassword&&u(r=>({...r,newPassword:""}))},className:`pl-10 pr-10 ${o.newPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>V(!f),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f?s.jsx(b,{className:"h-4 w-4"}):s.jsx(P,{className:"h-4 w-4"})})]}),o.newPassword?s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(N,{className:"h-3 w-3"}),o.newPassword]}):e.newPassword&&s.jsxs("p",{className:`text-sm font-medium ${A.color}`,children:["Strength: ",A.strength]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"confirm-password",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(j,{id:"confirm-password",type:h?"text":"password",placeholder:"Confirm new password",value:e.confirmPassword,onChange:a=>{n(r=>({...r,confirmPassword:a.target.value})),o.confirmPassword&&u(r=>({...r,confirmPassword:""}))},className:`pl-10 pr-10 ${o.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>$(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?s.jsx(b,{className:"h-4 w-4"}):s.jsx(P,{className:"h-4 w-4"})})]}),o.confirmPassword?s.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[s.jsx(N,{className:"h-3 w-3"}),o.confirmPassword]}):e.confirmPassword&&e.newPassword===e.confirmPassword&&s.jsxs("p",{className:"text-sm font-medium text-green-600 flex items-center gap-1",children:[s.jsx(is,{className:"h-3 w-3"}),"Passwords match"]})]})]}),s.jsx("div",{className:"flex gap-3",children:s.jsx(W,{type:"submit",disabled:C||!e.currentPassword||!e.newPassword||!e.confirmPassword,className:"flex-1",children:C?"Updating...":"Update Password"})})]}),s.jsx(J,{open:_,onOpenChange:p,children:s.jsxs(K,{children:[s.jsxs(Q,{children:[s.jsxs(X,{className:"flex items-center gap-2",children:[s.jsx(y,{className:"h-5 w-5 text-amber-500"}),"Confirm Password Change"]}),s.jsx(ss,{children:s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsx("p",{children:"Are you sure you want to change your password? This action will:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[s.jsx("li",{children:"Update your account password immediately"}),s.jsx("li",{children:"Log you out from all devices and sessions"}),s.jsx("li",{children:"Require you to log back in with your new password"})]}),s.jsx("p",{className:"font-medium text-amber-600",children:"Make sure you remember your new password before proceeding."})]})})]}),s.jsxs(es,{children:[s.jsx(rs,{children:"Cancel"}),s.jsx(as,{onClick:H,className:"bg-blue-600 hover:bg-blue-700",children:"Yes, Change Password"})]})]})})]})]})]})}export{ls as B,F as C,Ns as P,Ps as T,E as a,T as b,z as c,L as d,bs as e,cs as f,us as g,ms as h};
